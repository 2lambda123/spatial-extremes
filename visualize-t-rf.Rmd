```{r}
library(dplyr)
library(ggplot2)
```

We'll create a little function that generates a longform data frame with a certain number of knots with their values drawn from a multivariate t-distribution. The covariance matrix is based on the same exponential decay with Euclidean distance.

```{r}
# Simulate data and grid
make_rf <- function(seed, df, N = 1, nKnots=20) {
  grid = as.matrix(expand.grid("lon" = seq(1,20,1), "lat" = seq(1,20,1)))
  nLocs = dim(grid)[1]
  set.seed(seed)
  knots = jitter(cluster::pam(grid,nKnots)$medoids)
  distKnots = as.matrix(dist(knots))
  distKnotsSq = distKnots^2
  gp_scale = 0.001
  sigma.norm = 0.01
  corKnots = exp(-gp_scale*distKnotsSq)
  Sigma.normal = corKnots * sigma.norm * sigma.norm
  x <- mvtnorm::rmvt(N, sigma = Sigma.normal, df = df)
  x <- x - mean(x)
  reshape2::melt(x) %>%
    data.frame(knots) %>%
    select(-Var1, -Var2)
}
```

Now call the function with three different df's and for different seeds. The seed will be the same for the different degrees of freedom  so that the draws are comparable.

```{r}
pars <- expand.grid(seed = 100:104, df = c(2, 4, 1e6))
q <- plyr::mdply(pars, make_rf)
q <- group_by(q, seed) %>%
  mutate(scaled_value = as.numeric(scale(value, center = F, scale = F)))

p <- ggplot(q, aes(lon, lat, colour = scaled_value)) + geom_point(size = 5) +
  facet_grid(seed~df) + scale_color_gradient2()
print(p)
```

I tried centrering and scaling in various ways and cropping the colour scale and just leaving the tails but I think it's pretty obvious just from this plot what is happening. The big ups and the big downs get bigger with smaller degrees of freedom. The random field gets spikier.
